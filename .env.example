# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# SiteFlow Environment Configuration
# Copy this file to .env and customize for your environment
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# ──────────────────────────────────────────────────────────────────────────────
# INSTANCE CONFIGURATION (Required)
# ──────────────────────────────────────────────────────────────────────────────

# Master encryption key for instance secrets (SMTP/S3 credentials)
# Generate with: openssl rand -hex 32
INSTANCE_MASTER_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# Domain for production deployment
DOMAIN=localhost

# Bootstrap admin token for initial setup
# Generate with: openssl rand -base64 32
BOOTSTRAP_ADMIN_TOKEN=change-me-in-production

# ──────────────────────────────────────────────────────────────────────────────
# APPLICATION
# ──────────────────────────────────────────────────────────────────────────────

NODE_ENV=development

# API
API_PORT=3000
API_HOST=0.0.0.0

# Web (Vite dev server)
WEB_PORT=5173

# CORS origins (comma-separated)
CORS_ORIGINS=http://localhost:5173,http://localhost:3000

# JWT
JWT_SECRET=your-jwt-secret-change-in-production
JWT_ACCESS_EXPIRY=15m
JWT_REFRESH_EXPIRY=7d

# ──────────────────────────────────────────────────────────────────────────────
# DATABASE
# ──────────────────────────────────────────────────────────────────────────────

# PostgreSQL connection
DATABASE_URL=postgresql://siteflow:siteflow@localhost:5432/siteflow
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=siteflow
DATABASE_USER=siteflow
DATABASE_PASSWORD=siteflow

# Connection pool
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10

# ──────────────────────────────────────────────────────────────────────────────
# REDIS
# ──────────────────────────────────────────────────────────────────────────────

REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# ──────────────────────────────────────────────────────────────────────────────
# MINIO (S3-Compatible Storage)
# ──────────────────────────────────────────────────────────────────────────────

MINIO_ENDPOINT=localhost
MINIO_PORT=9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_USE_SSL=false
MINIO_BUCKET=siteflow

# Public URL for presigned URLs (production)
# MINIO_PUBLIC_URL=https://files.yourdomain.com

# ──────────────────────────────────────────────────────────────────────────────
# WORKER (BullMQ)
# ──────────────────────────────────────────────────────────────────────────────

WORKER_CONCURRENCY=5

# Job schedules (cron format)
JOB_OVERDUE_SCAN_CRON=30 6 * * *
JOB_INSPECTION_TIMEOUT_CRON=*/30 * * * *
JOB_REMINDERS_DAILY_CRON=0 7 * * *
JOB_REMINDERS_DMINUS_CRON=0 8 * * *

# ──────────────────────────────────────────────────────────────────────────────
# LOGGING
# ──────────────────────────────────────────────────────────────────────────────

LOG_LEVEL=info
LOG_PRETTY=true

# ──────────────────────────────────────────────────────────────────────────────
# RATE LIMITING
# ──────────────────────────────────────────────────────────────────────────────

RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW=15m

# ──────────────────────────────────────────────────────────────────────────────
# SECURITY
# ──────────────────────────────────────────────────────────────────────────────

# Cookie settings
COOKIE_SECURE=false
COOKIE_DOMAIN=localhost

# CSRF
CSRF_ENABLED=true

# ──────────────────────────────────────────────────────────────────────────────
# OPTIONAL: SMTP (can be configured via UI)
# ──────────────────────────────────────────────────────────────────────────────

# Leave empty to configure via Instance Admin UI
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USER=noreply@example.com
# SMTP_PASSWORD=
# SMTP_FROM=SiteFlow <noreply@example.com>
# SMTP_SECURE=false

# ──────────────────────────────────────────────────────────────────────────────
# OPTIONAL: External S3 (can be configured via UI)
# ──────────────────────────────────────────────────────────────────────────────

# Leave empty to use MinIO
# S3_REGION=us-east-1
# S3_BUCKET=siteflow-production
# S3_ACCESS_KEY=
# S3_SECRET_KEY=
# S3_ENDPOINT=  # Optional for S3-compatible services

# ──────────────────────────────────────────────────────────────────────────────
# DEVELOPMENT ONLY
# ──────────────────────────────────────────────────────────────────────────────

# Seed demo data on startup
SEED_DEMO_DATA=true

# Skip migrations check (not recommended)
SKIP_MIGRATIONS=false
